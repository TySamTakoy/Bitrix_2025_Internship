import requests
from sympy import mod_inverse

def get_factors_from_factordb(N):
    url = f"http://factordb.com/api?query={N}"
    data = requests.get(url).json()
    factors = data.get("factors", [])
    if len(factors) == 2:
        p = int(factors[0][0])
        q = int(factors[1][0])
        return p, q
    raise ValueError("Не удалось получить разложение N с factordb")

def rsa_decrypt_large(N, E, C):
    p, q = get_factors_from_factordb(N)
    print(f"Найдено разложение:\n p = {p}\n q = {q}")
    phi = (p - 1) * (q - 1)
    D = mod_inverse(E, phi)
    M = pow(C, D, N)
    return M

N = 303064257616594251424484693201721476326759723722885142397172522785244850162149467777077262616763634666043370043776556377672612393694156650080294923491656774270297835830691819365631476152833243761676761284450810253195741763806661956295880535771914878382524356687259890302543028387814854963781707333811249106203
E = 128152167650939478112960611086447690678938414623351023451668414316216597297081488257141743208818167755679889474106747568705995686531616611999042283281358887022864084487188184664068120961895742156615152967988934145628713184804156674885657229254646225388045928247273320869435792445718411785919945401333635890257
C = 203032768400248912196092405143777019829333496811298701933859195338588152768170428742689768294832525200244024597643308196441935131502880331644525230835991346369352289585324295730751832858449832363672002921994280321657965347512577716640265518900040413592246355430123887645745271920106792395721392713918465877869

M = rsa_decrypt_large(N, E, C)
print("\nРасшифрованное сообщение (в виде числа):", M)

try:
    print("Сообщение как текст:", bytes.fromhex(hex(M)[2:]).decode())
except Exception:
    print("Сообщение не похоже на текст.")